<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="google" content="notranslate">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Download data: HiLex</title>
        <!-- css -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="scripts_jscssphp/main.css">
        <!-- js -->
        <!--<script src='https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js'></script>-->
        <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
        <script type="text/javascript">
            $(function () { $('#my_nav').load('static/head_nonav_min.html');
                            $('#my_foot').load('static/foot_homePage.html'); });
        </script>
        <!-- favicons -->
        <link rel="apple-touch-icon" sizes="180x180" href="images/fav/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="images/fav/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="images/fav/favicon-16x16.png">
        <link rel="manifest" href="images/fav/site.webmanifest">
        <!-- css -->
        <style type="text/css">
            .card { background-color: #002349; }
            .btn-primary { background-color: #F4C654 !important; border-color: #F4C654 !important;}
            .btn-outline-primary {  border-color: #F4C654 !important; color: #F4C654 !important; }
        </style>
    </head>

<body>
	<!-- Navigation-->
	<div id="my_nav"></div>
	<!-- Header-->    

        <div id="StartBox" class="container" style="margin-bottom: 10px; margin-top: 50px; overflow: auto; min-height: calc(100% - 220px);">
        <div class="row justify-content-center">

            <div class="card  col-sm-12 col-lg-6">

                <div class="card-body">
                    <h2 class="card-title" id="helloTxt">Dear, experimenter !!!</h2>
                    <br>           
                    <p class="card-text">Please fill participant ID and completion code of your participant to download raw CSV files for participants' responses</p>
                    <div class="card-text form-group row">
                        <label class="col-sm-5 control-label text-left">Experiment name:</label>
                        <div class="col-sm-7">
                            <p class="card-text" id="expTxt">Full name of experiment (abcde)</p>
                        </div>
                    </div>
                    
                    <form id="start" name="start" method="GET" action="api.php">
                        <input type="hidden" name="expID" id="expID" />
                        <input type="hidden" name="expAbbr" id="expAbbr" />
                        <div class="card-text form-group row" id="pid_head1">
                            <label class="col-sm-5 control-label text-left" id='i00' for="partID">Participant ID: *</label>
                            <div class="col-sm-7 input-group">
                                <div class="input-group-prepend">
                                <span class="input-group-text" id="basic-addon1">FNOE</span>
                                </div>
                                 <input type="text" class="form-control" placeholder="please enter part ID" id="partID" name="partID" required>
                            </div>
                        </div>
                        <div class="card-text form-group row" id="pid_head2">
                            <label class="col-sm-5 control-label text-left" id='i01' for="compCode">Completion code:</label>
                            <div class="col-sm-7 input-group">
                                <div class="input-group-prepend">
                                <span class="input-group-text" id="basic-addon2">#</span>
                                </div>
                                <input type="text" class="form-control" placeholder="shown at the end of experiment" id="compCode" name="compCode">
                            </div>
                        </div>

                    

                    <br>

                    <center>
                    <!--a id="linkProfile" href="#abc" class="btn btn-primary" style="color: black; font-weight: bold;" onclick="triggerFunc()">Go to HiLex</a-->
                    <button id="linkProfile" type="submit" class="btn btn-primary mx-3 my-3" style="color: black;">Download Questionnaire</button>
                    <!--a id="linkProfile" href="#abc" type="submit" class="btn btn-primary mx-3 my-3" style="color: black;">Download HiLex (csv)</a-->
                    
                    <hr style="background-color:white">
                    <p class="card-text" style="font-size: 14px">Contact niketag@iitk.ac.in if you are facing any issues with file download or experiment</p>
                    </center>
                   </form> 

                </div>
            </div>
            
        </div>

        <p class="card-text" style="font-size: 20px; text-align: center !important; color: red !important; padding: 25px;"><strong>Note:</strong> This link is intended for the experimenter's use only, and should not be shared with participants or anyone else.</p>
    
    </div>


	

	<!-- Footer-->
	<div id="my_foot"></div>


</body>



<script type="text/javascript">
    function setValues() {
        var datHLX = (function() { var json = null;
            $.ajax({'async': false, 'global': false, 'cache':false, 'url': "data_experimenters/data/"+eID+"_HiLex.json", 'dataType': "json",
                'success': function(data) { json = data; } });
        return json;})();
        var datLBQ = (function() { var json = null;
                $.ajax({'async': false, 'global': false, 'cache':false, 'url': "data_experimenters/data/"+eID+"_profile.json", 'dataType': "json",
                    'success': function(data) { json = data; } });
            return json;})();
        var datEmail = (function() { var json = null;
                $.ajax({'async': false, 'global': false, 'cache':false, 'url': "data_experimenters/data/"+eID+"_HiLexEmail.json", 'dataType': "json",
                    'success': function(data) { json = data; } });
            return json;})();

        if(datHLX==null || datLBQ==null || datEmail==null) {
            document.getElementsByClassName('card-body')[0].innerHTML = '<h2 class="card-title">Error in finding file<br>please check email or contact Niket</h2>';
            return;
        }

        window.ABBR = datEmail[datEmail.length - 1].ExptAbbr;
        window.expName = datEmail[datEmail.length - 1].ExptName;
        window.expTitle = datEmail[datEmail.length - 1].ExptTitle;
        
        $('#expID')[0].value = eID; //hidden (just to send GET request)
        $('#expAbbr')[0].value = ABBR; //hidden (just to send GET request)

        $('#helloTxt')[0].innerHTML = "Dear, "+expName+" !!!"
        $('#expTxt')[0].innerHTML = expTitle + " (" + eID + ")"
        $('#basic-addon1')[0].innerHTML = ABBR
    }

    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    const eID = urlParams.get('expID');
    const pID = urlParams.get('pid');

    
    if(eID!=null && eID!="") {
        console.log("Okay")
        setValues()
    }
    else {
        document.getElementsByClassName('card-body')[0].innerHTML = '<h2 class="card-title">Error in URL<br>please check email or contact Niket</h2>';
    }

  
</script>


</html>

